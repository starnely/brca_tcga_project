labs(title = "Volcano Plot (adj.P.Val < 0.05)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
# For adj.P.Val < 0.05
significant_gene_at_0.05 <- results[results$adj.P.Val < 0.05, ]
significant_gene_at_0.05$Gene <- rownames(significant_gene_at_0.05)
significant_gene_at_0.05
# For adj.P.Val < 0.1
significant_gene_at_0.1 <- results[results$adj.P.Val < 0.1, ]
significant_gene_at_0.1$Gene <- rownames(significant_gene_at_0.1)
significant_gene_at_0.1
# Volcano plot for 0.1 threshold
# Add a column to label significant genes at 0.05
results$Significant_gene_at_0.1 <- ifelse(results$adj.P.Val < 0.1, "Yes", "No")
# Volcano plot for 0.1 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.1), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.1)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
# Volcano plot for 0.05 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.05), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.05)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
source("my_analysis.R", echo = FALSE)  # runs your code cleanly
source("brca_anlysis_r", echo = FALSE)  # runs your code cleanly
source("brca_anlysis_r.R", echo = FALSE)  # runs your code cleanly
source("brca_anlysis_r.R", echo = FALSE)  # runs your code cleanly
rm(list = ls())
source("barca_analysis.R", echo = FALSE)  # runs your code cleanly
source("barca_analysis.R", echo = FALSE)  # runs your code cleanly
rm(list = ls())
# Load libraries
library(survival)
library(survminer)
source("barca_analysis.R", echo = FALSE)  # runs your code cleanly
source("barca_analysis_r.R", echo = FALSE)  # runs your code cleanly
getwd()
source("barca_analysis.R", echo = FALSE)  # runs your code cleanly
source("barca_analysis_r.R", echo = FALSE)  # runs your code cleanly
source("brca_analysis_r.R", echo = FALSE)  # runs your code cleanly
source("brca_analysis_r.R", echo = FALSE)  # runs your code cleanly
source("barca_analysis_r.R", echo = FALSE)  # runs your code cleanly
source("brca_analysis_r.R", echo = FALSE)  # runs your code cleanly
source('brca_analysis_r.R' 'echo' = FALSE)
source("brca_analysis_r.R", echo = FALSE)
# Read expression data
expression_data <- read.csv("expression_data_for_R.csv", row.names = 1)
source("brca_analysis_r.R", echo = FALSE)
rm(list = ls())
source("~/brca_tcga_project/brca_analysis_r.R", echo = TRUE)
rm(list = ls())
# Load libraries
library(survival)
library(survminer)
library(GEOquery)
# Read expression data
expression_data <- read.csv("expression_data_for_R.csv", row.names = 1)
# Read clinical data
clinical_data <- read.csv("clinical_data_for_R.csv")
# Checking the shape of my two tables in R
dim(expression_data)
dim(clinical_data)
all(colnames(expression_data) == clinical_data$SampleID)
#Tells R which samples are Obese and non-Obese
#Converts BMI_group into a categorical variable
#Required for statistical modeling
clinical_data$BMI_group <- factor(clinical_data$BMI_group)
table(clinical_data$BMI_group)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("limma")
#limma is a statistical framework designed specifically for gene expression comparisons.
library(limma)
#Create the design matrix (this is the heart of the analysis)
#Compare gene expression between obese and non-obese samples.”
design <- model.matrix(~ BMI_group, data = clinical_data)
(design)
head(design)
#Fit the linear model (gene-by-gene)
#Fits a model for each gene
#Estimates expression difference between groups
#Stabilizes variance (critical for human data)
fit <- lmFit(expression_data, design)
fit <- eBayes(fit)
#| #Column    | Meaning (simple)           |
#| #Column    | Meaning (simple)           |
# | --------- | -------------------------- |
#| #logFC     | Direction & size of change |
#| #Column    | Meaning (simple)           |
# | --------- | -------------------------- |
#| #logFC     | Direction & size of change |
#| #P.Value   | Raw p-value                |
#| #adj.P.Val | FDR-corrected p-value      |
results <- topTable(
fit,
coef = "BMI_groupObese",
number = Inf,
adjust.method = "fdr"
)
(results)
#Count significant genes:
sum(results$adj.P.Val < 0.05)
# Subset significant genes
significant_genes <- results[results$adj.P.Val < 0.05, ]
# Check if any
if(nrow(significant_genes) > 0){
# If gene names are rownames
significant_gene_names <- rownames(significant_genes)
message("significant genes ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
#save results
write.csv(results, "DE_results_obese_vs_nonobese.csv")
library(ggplot2)
# Add a column to label significant genes at 0.05
results$Significant_gene_at_0.05 <- ifelse(results$adj.P.Val < 0.05, "Yes", "No")
# Volcano plot for 0.05 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.05), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.05)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
# For adj.P.Val < 0.05
significant_gene_at_0.05 <- results[results$adj.P.Val < 0.05, ]
significant_gene_at_0.05$Gene <- rownames(significant_gene_at_0.05)
significant_gene_at_0.05
# For adj.P.Val < 0.1
significant_gene_at_0.1 <- results[results$adj.P.Val < 0.1, ]
significant_gene_at_0.1$Gene <- rownames(significant_gene_at_0.1)
significant_gene_at_0.1
# Volcano plot for 0.1 threshold
# Add a column to label significant genes at 0.05
results$Significant_gene_at_0.1 <- ifelse(results$adj.P.Val < 0.1, "Yes", "No")
# Volcano plot for 0.1 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.1), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.1)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
View(significant_gene_at_0.1)
View(clinical_data)
View(design)
View(expression_data)
View(fit)
View(results)
View(significant_gene_at_0.05)
View(significant_gene_at_0.1)
View(significant_genes)
source("~/brca_tcga_project/brca_analysis_r.R", echo = TRUE)
View(results)
View(significant_genes)
source("~/brca_tcga_project/brca_analysis_r.R", echo = TRUE)
install.packages(c("purrr", "rlang"))
rm(list = ls())
# Load libraries
library(survival)
library(survminer)
library(GEOquery)
# Read expression data
expression_data <- read.csv("expression_data_for_R.csv", row.names = 1)
# Read clinical data
clinical_data <- read.csv("clinical_data_for_R.csv")
# Checking the shape of my two tables in R
dim(expression_data)
dim(clinical_data)
all(colnames(expression_data) == clinical_data$SampleID)
clinical_data$BMI_group <- factor(clinical_data$BMI_group)
table(clinical_data$BMI_group)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("limma")
#limma is a statistical framework designed specifically for gene expression comparisons.
library(limma)
#Create the design matrix (this is the heart of the analysis)
#Compare gene expression between obese and non-obese samples.”
design <- model.matrix(~ BMI_group, data = clinical_data)
(design)
head(design) ##checking how it looks(sample)
#Fit the linear model (gene-by-gene)
#Fits a model for each gene
#Estimates expression difference between groups
#Stabilizes variance (critical for human data)
fit <- lmFit(expression_data, design)
fit <- eBayes(fit)
results <- topTable(
fit,
coef = "BMI_groupObese",
number = Inf,
adjust.method = "fdr"
)
(results)
#Count significant genes:
sum(results$adj.P.Val < 0.05)
# Subset significant genes
significant_genes <- results[results$adj.P.Val < 0.05, ]
# Check if any
if(nrow(significant_genes) > 0){
# If gene names are rownames
significant_gene_names <- rownames(significant_genes)
message("significant genes ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
#save results
write.csv(results, "DE_results_obese_vs_nonobese.csv")
library(ggplot2)
# Add a column to label significant genes at 0.05
results$Significant_gene_at_0.05 <- ifelse(results$adj.P.Val < 0.05, "Yes", "No")
# Volcano plot for 0.05 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.05), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.05)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
# For adj.P.Val < 0.05
significant_gene_at_0.05 <- results[results$adj.P.Val < 0.05, ]
significant_gene_at_0.05$Gene <- rownames(significant_gene_at_0.05)
significant_gene_at_0.05
# For adj.P.Val < 0.1
significant_gene_at_0.1 <- results[results$adj.P.Val < 0.1, ]
significant_gene_at_0.1$Gene <- rownames(significant_gene_at_0.1)
significant_gene_at_0.1
# Volcano plot for 0.1 threshold
# Add a column to label significant genes at 0.05
results$Significant_gene_at_0.1 <- ifelse(results$adj.P.Val < 0.1, "Yes", "No")
# Volcano plot for 0.1 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.1), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.1)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
View(results)
View(significant_gene_at_0.1)
View(significant_gene_at_0.1)
View(significant_gene_at_0.1)
View(significant_gene_at_0.1)
View(significant_genes)
View(significant_gene_at_0.1)
View(significant_gene_at_0.1)
View(significant_gene_at_0.05)
View(significant_gene_at_0.1)
source("~/brca_tcga_project/brca_analysis_r.R", echo = TRUE)
View(significant_gene_at_0.1)
View(significant_genes)
View(significant_gene_at_0.05)
View(significant_gene_at_0.1)
# Volcano plot for 0.1 threshold
# Add a column to label significant genes at 0.05
results$Significant_gene_at_0.1 <- ifelse(results$adj.P.Val < 0.1, "Yes", "No")
# Volcano plot for 0.1 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.1), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.1)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
View(significant_gene_at_0.1)
View(results)
View(significant_gene_at_0.05)
View(significant_gene_at_0.1)
head(results[order(results$P.Value), ], 20)
library(ggplot2)
# Add a column to label significant genes at 0.05
results$Significant_gene_at_0.05 <- ifelse(results$adj.P.Val < 0.05, "Yes", "No")
# Volcano plot for 0.05 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.05), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.05)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
# For adj.P.Val < 0.05
significant_gene_at_0.05 <- results[results$adj.P.Val < 0.05, ]
significant_gene_at_0.05$Gene <- rownames(significant_gene_at_0.05)
significant_gene_at_0.05
#check the top 20genes genes with strongest evidence even if they did not pass the threshold
head(results[order(results$P.Value), ], 20)
# Subset significant genes
significant_genes <- results[results$adj.P.Val < 0.05, ]
rm(list = ls())
# Load libraries
library(survival)
library(survminer)
library(GEOquery)
# Read expression data
expression_data <- read.csv("expression_data_for_R.csv", row.names = 1)
# Read clinical data
clinical_data <- read.csv("clinical_data_for_R.csv")
# Checking the shape of my two tables in R
dim(expression_data)
dim(clinical_data)
all(colnames(expression_data) == clinical_data$SampleID)
clinical_data$BMI_group <- factor(clinical_data$BMI_group)
table(clinical_data$BMI_group)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("limma")
#Create the design matrix (this is the heart of the analysis)
#Compare gene expression between obese and non-obese samples.”
design <- model.matrix(~ BMI_group, data = clinical_data)
(design) #checking how it looks
#Fit the linear model (gene-by-gene)
#Fits a model for each gene
#Estimates expression difference between groups
#Stabilizes variance (critical for human data)
fit <- lmFit(expression_data, design)
#Fit the linear model (gene-by-gene)
#Fits a model for each gene
#Estimates expression difference between groups
#Stabilizes variance (critical for human data)
fit <- lmFit(expression_data, design)
#limma is a statistical framework designed specifically for gene expression comparisons.
library(limma)
#Create the design matrix (this is the heart of the analysis)
#Compare gene expression between obese and non-obese samples.”
design <- model.matrix(~ BMI_group, data = clinical_data)
(design) #checking how it looks
head(design) ##checking how it looks(sample)
#Fit the linear model (gene-by-gene)
#Fits a model for each gene
#Estimates expression difference between groups
#Stabilizes variance (critical for human data)
fit <- lmFit(expression_data, design)
fit <- eBayes(fit)
results <- topTable(
fit,
coef = "BMI_groupObese",
number = Inf,
adjust.method = "fdr"
)
(results)
View(results)
# Check if any
if(nrow(significant_genes) > 0){
# If gene names are rownames
significant_gene_names <- rownames(significant_genes)
message("significant genes ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
# Subset significant genes
significant_genes <- results[results$adj.P.Val < 0.05, ]
View(significant_genes)
# Check if any
if(nrow(significant_genes) > 0){
# If gene names are rownames
significant_gene_names <- rownames(significant_genes)
message("significant genes ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
View(significant_genes)
# From the results table, keep only the genes whose adjusted p-value is less than 0.05
significant_genes <- results[results$adj.P.Val < 0.05, ]
# Check if any
if(nrow(significant_genes) > 0){
# If gene names are rownames
significant_gene_names <- rownames(significant_genes)
message("significant genes ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
# From the results table, keep only the genes whose adjusted p-value is less than 0.05
significant_gene_at_0.05 <- results[results$adj.P.Val < 0.05, ]
# Check if any
if(nrow(significant_gene_at_0.05) > 0){
# If gene names are rownames
significant_gene_names <- rownames(significant_genes)
message("significant genes ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
View(significant_gene_at_0.05)
# Check if any
if(nrow(significant_gene_at_0.05) > 0){
# If gene names are row names
significant_gene_names <- rownames(significant_gene_at_0.05)
message("significant genes at pvalue 0.05 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
#I Decided th adjusted p value to 0.1
# From the results table, keep only the genes whose adjusted p-value is less than 0.1
significant_genes_at_0.1 <- results[results$adj.P.Val < 0.1, ]
View(significant_genes_at_0.1)
#look at them
if(nrow(significant_gene_at_0.1) > 0){
# If gene names are row names
significant_gene_names <- rownames(significant_gene_at_0.1)
message("significant genes at pvalue 0.1 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.1")
}
#I Decided th adjusted p value to 0.1
# From the results table, keep only the genes whose adjusted p-value is less than 0.1
significant_genes_at_0.1 <- results[results$adj.P.Val < 0.1, ]
#look at them
if(nrow(significant_gene_at_0.1) > 0){
# If gene names are row names
significant_gene_names <- rownames(significant_gene_at_0.1)
message("significant genes at pvalue 0.1 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.1")
}
#Count significant genes:
sum(results$adj.P.Val < 0.1)
# From the results table, keep only the genes whose adjusted p-value is less than 0.1
significant_genes_at_0.1 <- results[results$adj.P.Val < 0.1, ]
#look at them
if(nrow(significant_gene_at_0.1) > 0){
# If gene names are row names
significant_gene_names <- rownames(significant_gene_at_0.1)
message("significant genes at pvalue 0.1 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.1")
}
#look at them
if(nrow(significant_gene_at_0.1) > 0){
# If gene names are row names
significant_gene_names <- rownames(significant_genes_at_0.1)
message("significant genes at pvalue 0.1 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.1")
}
# From the results table, keep only the genes whose adjusted p-value is less than 0.1
significant_genes_at_0.1 <- results[results$adj.P.Val < 0.1, ]
#look at them
if(nrow(significant_gene_at_0.1) > 0){
# If gene names are row names
significant_gene_names <- rownames(significant_genes_at_0.1)
message("significant genes at pvalue 0.1 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.1")
}
#look at them
if(nrow(significant_genes_at_0.1) > 0){
# If gene names are row names
significant_gene_names <- rownames(significant_genes_at_0.1)
message("significant genes at pvalue 0.1 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.1")
}
View(significant_genes_at_0.1)
View(significant_genes_at_0.1)
View(significant_genes)
View(significant_genes)
#check the top 20genes genes with strongest evidence even if they did not pass the threshold
head(results[order(results$P.Value), ], 20)
#save results
write.csv(results, "DE_results_obese_vs_nonobese.csv")
getwd()
library(ggplot2)
# Add a column to label significant genes at 0.05
results$Significant_gene_at_0.05 <- ifelse(results$adj.P.Val < 0.05, "Yes", "No")
# Volcano plot for 0.05 threshold
ggplot(results, aes(x = logFC, y = -log10(adj.P.Val))) +
geom_point(aes(color = Significant_gene_at_0.05), alpha = 0.6) +
scale_color_manual(values = c("No" = "grey", "Yes" = "red")) +
theme_minimal() +
labs(title = "Volcano Plot (adj.P.Val < 0.05)",
x = "log2 Fold Change", y = "-log10(adj.P.Val)")
View(significant_gene_at_0.05)
View(significant_genes)
View(significant_gene_at_0.05)
View(significant_genes_at_0.1)
# Check if any
if(nrow(significant_gene_at_0.05) > 0){
# If gene names are row names
significant_gene_names$Gene <- rownames(significant_gene_at_0.05)
message("significant genes at pvalue 0.05 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
View(significant_gene_names)
# If gene names are row names
significant_gene_names <- rownames(significant_gene_at_0.05)
# Check if any
if(nrow(significant_gene_at_0.05) > 0){
# If gene names are row names
significant_gene_names$Gene <- rownames(significant_gene_at_0.05)
message("significant genes at pvalue 0.05 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
View(significant_gene_names)
# Check if any
if(nrow(significant_gene_at_0.05) > 0){
# If gene names are row names
significant_gene_name <- rownames(significant_gene_at_0.05)
message("significant genes at pvalue 0.05 is ",significant_gene_names)
} else {
message("No significant genes at adj.P.Val < 0.05")
}
source("~/brca_tcga_project/brca_analysis_r.R", echo = TRUE)
View(significant_gene_at_0.05)
head(clinical_data)
colnames(clinical_data)
# Checking the shape of my two tables in R
dim(expression_data)
dim(clinical_data)
View(clinical_data)
View(clinical_data)
View(results)
